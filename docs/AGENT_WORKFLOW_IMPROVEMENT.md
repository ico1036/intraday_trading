# Agent Workflow ê°œì„  ê³„íš

> ìž‘ì„±ì¼: 2026-01-09
> ëª©ì : ë™ì  í”Œëž˜ë‹ ê¸°ë°˜ ì „ëžµ ê°œì„  ì›Œí¬í”Œë¡œìš° êµ¬í˜„

---

## 1. í˜„ìž¬ ë¬¸ì œì 

### 1.1 í˜„ìž¬ Agent Workflow (ì •ì  í”Œëž˜ë‹)

```
Researcher â†’ Developer â†’ Analyst â†’ (ì„±ê³µ/ì‹¤íŒ¨) â†’ ë‹¤ìŒ iteration
```

**í•œê³„:**
- ë‹¨ì¼ ê°€ì„¤ â†’ ë‹¨ì¼ í…ŒìŠ¤íŠ¸ â†’ ì„±ê³µ/ì‹¤íŒ¨ íŒë‹¨
- ì‹¤í—˜ ê²°ê³¼ì—ì„œ "ì™œ"ë¥¼ ë¶„ì„í•˜ì§€ ì•ŠìŒ
- ë²„ì „ ê´€ë¦¬ / A/B ë¹„êµ ì—†ìŒ
- ì¸ì‚¬ì´íŠ¸ ê¸°ë°˜ ë™ì  ë°©í–¥ ì „í™˜ ì—†ìŒ
- ì½”ë“œ ìžì²´ë¥¼ ë¶„ì„í•˜ê³  ë¡œì§ ë¬¸ì œë¥¼ ì°¾ëŠ” ë‹¨ê³„ ì—†ìŒ

### 1.2 ì›í•˜ëŠ” Workflow (ë™ì  í”Œëž˜ë‹)

```
ë¬¸ì œ ë°œê²¬ â†’ ì›ì¸ ê°€ì„¤ ë¦¬ìŠ¤íŒ… â†’ ìš°ì„ ìˆœìœ„ ê²°ì • â†’ ì‹¤í—˜ 
    â†’ ê²°ê³¼ ë¶„ì„ & ì¸ì‚¬ì´íŠ¸ â†’ ë™ì  ì˜ì‚¬ê²°ì • â†’ ë‹¤ìŒ ê°€ì„¤
```

**í•„ìš”í•œ ê²ƒ:**
- ì—¬ëŸ¬ ê°€ì„¤ ë™ì‹œ ê´€ë¦¬ (Hypothesis Tree)
- ì‹¤í—˜ ê²°ê³¼ì—ì„œ "ì™œ" ë¶„ì„ (Causal Analysis)
- ì¸ì‚¬ì´íŠ¸ ì¶•ì  (ì‹¤íŒ¨ì—ì„œë„ ë°°ì›€)
- ë™ì  ì˜ì‚¬ê²°ì • (REVERT/CONTINUE/NEW_HYPOTHESIS)
- ë²„ì „ ê´€ë¦¬ (v3, v3.5, v4)

---

## 2. í•„ìš”í•œ Agent ê°œì„ 

### 2.1 Agent ì—­í•  ë¶„ë¦¬ (ê¶Œìž¥: 4 Agent ì²´ì œ)

| Agent | ì—­í•  (3-4ê°œ) | ìƒˆë¡œ ì¶”ê°€ |
|-------|-------------|-----------|
| **Researcher** | ê°€ì„¤ ì„¤ê³„, algorithm_prompt.txt, ì¸ì‚¬ì´íŠ¸ ê¸°ë°˜ ê°€ì„¤ ìˆ˜ì • | ì½”ë“œ ë¶„ì„, ê°€ì„¤ íŠ¸ë¦¬ ê´€ë¦¬ |
| **Developer** | ì½”ë“œ êµ¬í˜„, ë²„ì „ ê´€ë¦¬, ë³€ê²½ ê¸°ë¡ | ë²„ì „ ê´€ë¦¬ |
| **Analyst** | ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰, ë©”íŠ¸ë¦­ ê³„ì‚°, Before/After ë¹„êµ, Pass/Fail | Before/After ë¹„êµ |
| **Strategist (NEW)** | ì½”ë“œ ë¶„ì„, ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ, ë™ì  ì˜ì‚¬ê²°ì •, ë‹¤ìŒ ì‹¤í—˜ í”Œëž˜ë‹ | ì „ì²´ ìƒˆë¡œ ì¶”ê°€ |

### 2.2 ë‹¨ì¼ Agent ë³µìž¡ë„ ê´€ë¦¬

| ì—­í•  ìˆ˜ | Opus 4.5 | í’ˆì§ˆ |
|---------|----------|------|
| 2-3ê°œ | âœ… ìš°ìˆ˜ | ì¼ê´€ë˜ê³  ê¹Šì€ ë¶„ì„ |
| 4-5ê°œ | âœ… ì–‘í˜¸ | ëŒ€ë¶€ë¶„ ìž˜ ë™ìž‘ |
| 6-7ê°œ | âš ï¸ ìœ„í—˜ | ê°€ë” ë†“ì¹¨ |
| 8ê°œ+ | ðŸ”´ ë¶€ì í•© | í’ˆì§ˆ ì €í•˜, ì¼ê´€ì„±â†“ |

**ì›ì¹™:** "í•˜ë‚˜ì˜ ë˜‘ë˜‘í•œ agent"ë³´ë‹¤ "ì—¬ëŸ¬ ê°œì˜ ì§‘ì¤‘ëœ agent"

---

## 3. êµ¬ì¡°í™”ëœ Memory í¬ë§·

### 3.1 ì‹¤í—˜ ížˆìŠ¤í† ë¦¬ (experiments.json)

```json
{
  "experiments": [
    {
      "version": "v3",
      "parent": null,
      "changes": [],
      "metrics": {
        "win_rate": 65,
        "avg_win": 0.3,
        "profit_factor": 1.2,
        "total_return": 8.5
      },
      "status": "BASELINE"
    },
    {
      "version": "v4",
      "parent": "v3",
      "changes": ["OFI normalization ì œê±°"],
      "hypothesis": "OFI normì´ ë¶ˆí•„ìš”í•œ ì†ì‹¤ ì²­ì‚° ìœ ë°œ",
      "metrics": {...},
      "insight": "OFI normì´ win rate ë³´í˜¸",
      "decision": "REVERT",
      "revert_to": "v3"
    }
  ],
  "active_version": "v3",
  "pending_hypotheses": ["Trailing Stop ìˆ˜ì •", "ì»¨ì…‰ ìž¬ì •ë¦½"]
}
```

### 3.2 Memory.md í™•ìž¥ í¬ë§·

```markdown
# Experiment History

## v3 (baseline)
- **Changes**: Initial implementation
- **Metrics**: WR=65%, AvgWin=0.3%, PF=1.2
- **Status**: BASELINE

## v4 (from v3)
- **Changes**: OFI normalization ì œê±°
- **Hypothesis**: "OFI normì´ ë¶ˆí•„ìš”í•œ ì†ì‹¤ ì²­ì‚° ìœ ë°œ"
- **Metrics**: WR=55%, AvgWin=0.5%, PF=1.1
- **Insight**: "OFI normì´ win rate ë³´í˜¸ ì—­í• "
- **Decision**: REVERT to v3
- **Learning**: OFI norm ìœ ì§€, ë‹¤ë¥¸ ìš”ì†Œ ê°œì„ 

## Hypothesis Queue
1. [TESTED] OFI normalization â†’ ìœ ì§€
2. [TESTED] VPIN ê³„ì‚° â†’ BVC ìœ ì§€
3. [PENDING] Trailing Stop ìˆ˜ì •
4. [PENDING] ì»¨ì…‰ ìž¬ì •ë¦½ (Absorption)
```

---

## 4. Analyst Agent Prompt ê°œì„ ì•ˆ

### 4.1 ì¶”ê°€í•  Step: Causal Analysis

```markdown
## Step 4.5: Causal Analysis (NEW)

### Before/After ë¹„êµ
| Metric | Before (v{N-1}) | After (v{N}) | Change |
|--------|-----------------|--------------|--------|
| win_rate | {X}% | {Y}% | {diff} |
| avg_win | {X}% | {Y}% | {diff} |
| total_return | {X}% | {Y}% | {diff} |

### ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ
- ë³€ê²½ ì‚¬í•­: {ë¬´ì—‡ì„ ë°”ê¿¨ë‚˜}
- ê²°ê³¼ í•´ì„: {ì™œ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì™”ë‚˜}
- íŠ¸ë ˆì´ë“œì˜¤í”„: {ê°œì„ ëœ ê²ƒ vs ì•…í™”ëœ ê²ƒ}

### ë‹¤ìŒ í–‰ë™ ê²°ì •
| ê²°ê³¼ íŒ¨í„´ | í–‰ë™ |
|-----------|------|
| ì „ë°˜ì  ê°œì„  | KEEP, ë‹¤ìŒ ê°€ì„¤ í…ŒìŠ¤íŠ¸ |
| íŠ¸ë ˆì´ë“œì˜¤í”„ | ë¶„ì„ í›„ KEEP/REVERT ê²°ì • |
| ì „ë°˜ì  ì•…í™” | REVERT, ì¸ì‚¬ì´íŠ¸ ì €ìž¥ |
| íŠœë‹ ìœ í˜¹ | âš ï¸ overfitting ê²½ê³„! |
```

---

## 5. ìƒˆ Agent: Strategist (ë˜ëŠ” Code Reviewer)

### 5.1 ì—­í• 

```markdown
## Strategist Agent

### Mission
ì½”ë“œ ë¶„ì„, ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ, ë™ì  ì˜ì‚¬ê²°ì •

### Responsibilities (3-4ê°œ)
1. **ì½”ë“œ ë¶„ì„**: ê¸°ì¡´ ì „ëžµ ì½”ë“œ ì½ê³  ë¡œì§ íŒŒì•…
2. **ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ**: ì‹¤í—˜ ê²°ê³¼ì—ì„œ "ì™œ" ë¶„ì„
3. **ë™ì  ì˜ì‚¬ê²°ì •**: REVERT/CONTINUE/NEW_HYPOTHESIS ê²°ì •
4. **ë‹¤ìŒ ì‹¤í—˜ í”Œëž˜ë‹**: ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ê°€ì„¤ ì„ íƒ

### Inputs
- ì „ëžµ ì½”ë“œ (strategy.py)
- ì‹¤í—˜ ê²°ê³¼ (metrics)
- ì´ì „ ì¸ì‚¬ì´íŠ¸ (memory.md)

### Outputs
- ì¸ì‚¬ì´íŠ¸ (insights.md)
- ë‹¤ìŒ í–‰ë™ (next_action)
- ê°€ì„¤ ìš°ì„ ìˆœìœ„ (hypothesis_queue)
```

---

## 6. ê°œì„ ëœ Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Strategist: ë¬¸ì œ ë¶„ì„ & ê°€ì„¤ ë¦¬ìŠ¤íŒ…                        â”‚
â”‚  - ë©”íŠ¸ë¦­ ë¶„ì„ (win-rateâ†‘, RRâ†“)                            â”‚
â”‚  - ì½”ë“œ ë¶„ì„ (ë¡œì§ ë¬¸ì œ ë°œê²¬)                               â”‚
â”‚  - ì›ì¸ ê°€ì„¤ ìƒì„± (ì—¬ëŸ¬ ê°œ)                                 â”‚
â”‚  - ìš°ì„ ìˆœìœ„ ê²°ì •                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Researcher: ê°€ì„¤ êµ¬ì²´í™”                                    â”‚
â”‚  - ì„ íƒëœ ê°€ì„¤ ê¸°ë°˜ algorithm_prompt.txt ìˆ˜ì •               â”‚
â”‚  - ë³€ê²½ ì‚¬í•­ ëª…ì‹œ                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer: êµ¬í˜„ & ë²„ì „ ê´€ë¦¬                                â”‚
â”‚  - ì½”ë“œ ìˆ˜ì • (v3 â†’ v4)                                     â”‚
â”‚  - ë³€ê²½ ê¸°ë¡                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Analyst: ì‹¤í–‰ & ë©”íŠ¸ë¦­                                     â”‚
â”‚  - ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰                                            â”‚
â”‚  - Before/After ë¹„êµ                                        â”‚
â”‚  - ë©”íŠ¸ë¦­ ë¦¬í¬íŠ¸                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Strategist: ì¸ì‚¬ì´íŠ¸ & ì˜ì‚¬ê²°ì •                            â”‚
â”‚  - "ì™œ" ë¶„ì„                                                â”‚
â”‚  - ì¸ì‚¬ì´íŠ¸ ì €ìž¥                                            â”‚
â”‚  - REVERT/CONTINUE/NEW_HYPOTHESIS ê²°ì •                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                    ë‹¤ìŒ ê°€ì„¤ë¡œ... (ë£¨í”„)
```

---

## 7. êµ¬í˜„ ìš°ì„ ìˆœìœ„

| ìˆœì„œ | í•­ëª© | ë‚œì´ë„ | ì˜í–¥ë„ |
|------|------|--------|--------|
| 1 | Analyst promptì— Causal Analysis ì¶”ê°€ | ë‚®ìŒ | ë†’ìŒ |
| 2 | Memory.md í¬ë§· êµ¬ì¡°í™” | ë‚®ìŒ | ë†’ìŒ |
| 3 | experiments.json ìŠ¤í‚¤ë§ˆ ì •ì˜ | ë‚®ìŒ | ì¤‘ê°„ |
| 4 | Strategist Agent ìƒì„± | ì¤‘ê°„ | ë†’ìŒ |
| 5 | Developerì— ë²„ì „ ê´€ë¦¬ ì¶”ê°€ | ë‚®ìŒ | ì¤‘ê°„ |
| 6 | Researcherì— ì¸ì‚¬ì´íŠ¸ ê¸°ë°˜ ìž¬ì„¤ê³„ ì¶”ê°€ | ì¤‘ê°„ | ë†’ìŒ |

---

## 8. ì£¼ì˜ì‚¬í•­

### 8.1 ìƒˆ Tool ë¶ˆí•„ìš”
- ë²„ì „ ê´€ë¦¬: Git ë˜ëŠ” íŒŒì¼ ì‹œìŠ¤í…œìœ¼ë¡œ ì¶©ë¶„
- ì‹¤í—˜ ì¶”ì : JSON/parquet íŒŒì¼ë¡œ ì¶©ë¶„
- ì¸ì‚¬ì´íŠ¸ ì €ìž¥: memory.md í™•ìž¥ìœ¼ë¡œ ì¶©ë¶„

### 8.2 í•µì‹¬
> ë„êµ¬ ë¬¸ì œê°€ ì•„ë‹ˆë¼ **"ì–´ë–»ê²Œ ìƒê°í•˜ë¼ê³  ì§€ì‹œí•˜ëŠëƒ"** ë¬¸ì œ

### 8.3 Agent ë³µìž¡ë„ ê´€ë¦¬
- ë‹¨ì¼ Agent ì—­í• : 3-5ê°œ ê¶Œìž¥
- 8ê°œ ì´ìƒ: í’ˆì§ˆ ì €í•˜ ìœ„í—˜
- í•´ê²°ì±…: Agent ë¶„ë¦¬ ë˜ëŠ” ë‹¨ê³„ë³„ í˜¸ì¶œ

---

## Appendix: OFI VPIN Explosion Strategy ê°œì„ ì•ˆ

(ì „ëžµ ì½”ë“œ ë¶„ì„ì—ì„œ ë„ì¶œëœ ê°œì„ ì•ˆ)

### A.1 ì»¨ì…‰ ëª…í™•í™”

**ê¸°ì¡´ (ë¶€ì •í™•):** "Exhaustion - ê·¹ë‹¨ì  OFI = íž˜ ë¹ ì§"

**ìˆ˜ì • (ì •í™•):** "**Absorption Pattern** - ì €ë³€ë™ì„±ì—ì„œ ê·¹ë‹¨ì  OFI = ëˆ„êµ°ê°€ í¡ìˆ˜ ì¤‘, í¡ìˆ˜ ì™„ë£Œ í›„ ë°˜ì „"

### A.2 ê°œì„ ì•ˆ ëª©ë¡

| # | ê°œì„ ì•ˆ | ìƒíƒœ | ê²°ê³¼ |
|---|--------|------|------|
| 1 | OFI normalization ì‚­ì œ | TESTED | avg_winâ†‘, total_returnâ†“ â†’ REVERT |
| 2 | Trailing Stop ìˆ˜ì • (maxë¡œë¶€í„° ê±°ë¦¬) | PENDING | - |
| 3 | VPIN ê³„ì‚° ë³€ê²½ (delta ìž¬ì‚¬ìš©) | TESTED | ì•…í™” â†’ REVERT |
| 4 | VPIN í†µê³„ì  ì‹ ë¢°ë„ (z-score) | PENDING | - |

### A.3 ì½”ë“œ ê°œì„  ìƒì„¸

#### Trailing Stop ìˆ˜ì •

```python
# í˜„ìž¬ (ë¬¸ì œ): ê³ ì • 0.2%
if max_profit >= 0.5% and current <= 0.2%:
    ì²­ì‚°!

# ê°œì„ : maxë¡œë¶€í„° ê±°ë¦¬
trail_distance = 0.003  # 30bp
if max_profit >= activation_threshold:
    trailing_stop_level = max_profit - trail_distance
    if current <= trailing_stop_level:
        ì²­ì‚°!
```

#### VPIN ê³„ì‚° (ì¸ì‚¬ì´íŠ¸: BVC ìœ ì§€)

```python
# í…ŒìŠ¤íŠ¸í•œ ê²ƒ (ì‹¤íŒ¨)
VPIN = ts_sum(abs(delta), N) / ts_sum(volume, N)

# ìœ ì§€ (BVC)
z_score = (close - open) / sigma
buy_prob = Î¦(z_score)
VPIN = Î£|V_buy - V_sell| / Î£ volume

# ì¸ì‚¬ì´íŠ¸: ê°€ê²© ì •ë³´(BVC)ê°€ ì •ë³´ì„± ê±°ëž˜ ì‹ í˜¸ì— ì¤‘ìš”
```

---

*ì´ ë¬¸ì„œëŠ” ì¶”í›„ Agent Workflow ê°œì„  ì‹œ ì°¸ê³ ìš©ìœ¼ë¡œ ìž‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*

